<!DOCTYPE html>
    <head>
        <title>App register</title>
        <meta charset="utf-8" />
        <meta name = "author" content="Yin Chen yc153">
    </head>
    
    <body>
        <script>
            //  Hidden field contains the current timestamp in millis when the page is loaded
            function setTimeStamp(){
                document.getElementById("timeStamp").value = Date.now();
                console.log("set time");
            }

            setTimeStamp();
            function getTime() {
                return Date.now();
            }
            
            // Validate account name
            function isAccountNameValid(){
                let accountName =  document.getElementById("accName").value;
                if (accName.length === 0) {
                    alert("Account name cannot be empty.");
                    return false;
                }
    
                if (accName[0] >= '0' && accName[0] <= '9') {
                    alert("Account name cannot start with a number.");
                    return false;
                }
    
                for (let i = 0; i < accName.length; i++) {
                    let char = accName[i];
    
                    if (!(char >= 'a' && char <= 'z') && 
                        !(char >= 'A' && char <= 'Z') && 
                        !(char >= '0' && char <= '9')) {
                        alert("Account name can only contain letters and numbers.");
                        return false;
                    }
                }
    
                return true;
            }
    
            // Only users aged 18 or older on the date of registration are valid
            function isAdult(){
                let dateOfBirth = new Date(document.getElementById("dob").value);
                let currentTime = new Date();
    
                let age = currentTime.getFullYear() - dateOfBirth.getFullYear();
    
                if (currentTime.getMonth() < dateOfBirth.getMonth() || (currentTime.getMonth() === dateOfBirth.getMonth() && currentTime.getDate() < dateOfBirth.getDate())) {
                    age -= 1;
                }
    
                return age >= 18;
            }
    
            // Validate password
            function isPasswordEqual(){
                let pw1 = document.getElementById("password1").value;
                let pw2 = document.getElementById("password2").value;
                
                return pw1 === pw2;
    
            }

            
            // Helpful alert to user of invalid form contents
            // Submit button executes JavaScript validation function before submitting form
            function submitForm(){
                
                if (!isAdult()) {
                    alert("User must be 18 years or older to register");
                    return false;
                }
                if (!isPasswordEqual()) {
                    alert("Confirmation password does not match the input password");
                    return false;
                }
                if(!isAccountNameValid()){
                    return false;
                }
                return true;

                
            }
    
        </script>
        <h1>Registration</h1>
        <form id = "register" method = "GET" action = "./formProcessor.html" name = "form" onsubmit="return submitForm()">
            <p>
                Account Name: <br>
                <input type = "text" placeholder = "your name" id = "accName" name = "accName" required>
            </p>
            <p>
                Display Name(optional): <br>
                <input type = "text" placeholder = "your name" id = "disName" name = "disName">
            </p>
            <p>
                Email Address: <br>
                <input type = "email" placeholder = "delivery address" id = "email" name = "email" required>
            </p>
            <p>
                Phone Number: 123-123-1234 <br>
                <input type = "text" placeholder = "123-123-1234" id = "phone" name = "phone" required pattern="^\d{3}-\d{3}-\d{4}$">
            </p>
            <p>
                Date of Birth: <br>
                <input type = "date" id = "dob" name = "dob" required>
            </p>
            <p>
                Zipcode: <br>
                <input type = "text" placeholder = "77005" id = "zipCode" name = "zipCode" required pattern="[0-9]{5}">
            </p>
            <p>
                Password: <br>
                <input type = "password" id = "password1" name="password1" required>
            </p>
            <p>
                Password Confirmation: <br>
                <input type = "password" id = "password2" required>
            </p>
            <input type = "hidden" name="timeStamp" id="timeStamp">
            
            <input type = "submit" value= "Register">
            <input type = "reset" value = "Clear">
        </form>
       
    </body>
    
    
</html>